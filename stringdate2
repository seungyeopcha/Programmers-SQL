-- 루시와 엘라찾기
SELECT animal_id, name, sex_upon_intake
from animal_ins
where name in ('Lucy','Ella','Pickle','Rogan','Sabrina','Mitty');

-- 이름에 el이 들어가는 동물 찾기
SELECT animal_id, name
from animal_ins
where animal_type='Dog' and name like '%EL%'
order by name;

-- 중성화 여부파악
SELECT animal_id, name,
    case when sex_upon_intake like 'Neutered%' then 'O' 
        when  sex_upon_intake like 'Spayed%' then 'O'
        else 'X' end 중성화
from animal_ins
order by animal_id;

-- 입양을 간 동물 중, 보호 기간이 가장 길었던 동물 두 마리의 아이디와 이름을 조회
SELECT i.animal_id, i.name
from animal_ins as i
inner join animal_outs as o
on i.animal_id=o.animal_id
order by i.datetime-o.datetime asc
limit 2;

-- datetime to date
SELECT animal_id, name, date_format(datetime, '%Y-%m-%d') 날짜
from animal_ins
order by animal_id;
